<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libASPL: aspl::DoubleBuffer&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libASPL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classaspl_1_1_double_buffer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classaspl_1_1_double_buffer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">aspl::DoubleBuffer&lt; T &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Doubly-buffered value with non-blocking read and blocking write.  
 <a href="classaspl_1_1_double_buffer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_double_buffer_8hpp_source.html">aspl/DoubleBuffer.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html">ReadLock</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read lock.  <a href="classaspl_1_1_double_buffer_1_1_read_lock.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab904556765cb532ac19a40d79da100bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaspl_1_1_double_buffer.html#ab904556765cb532ac19a40d79da100bd">DoubleBuffer</a> (const T &amp;value)</td></tr>
<tr class="memdesc:ab904556765cb532ac19a40d79da100bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize buffer with given value.  <a href="classaspl_1_1_double_buffer.html#ab904556765cb532ac19a40d79da100bd">More...</a><br /></td></tr>
<tr class="separator:ab904556765cb532ac19a40d79da100bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac667ea58ef5ad58f5b28f6cf32ce601b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaspl_1_1_double_buffer.html#ac667ea58ef5ad58f5b28f6cf32ce601b">DoubleBuffer</a> (T &amp;&amp;value=T())</td></tr>
<tr class="memdesc:ac667ea58ef5ad58f5b28f6cf32ce601b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize buffer with given value.  <a href="classaspl_1_1_double_buffer.html#ac667ea58ef5ad58f5b28f6cf32ce601b">More...</a><br /></td></tr>
<tr class="separator:ac667ea58ef5ad58f5b28f6cf32ce601b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1052ad4caa9dcc10e61545cdd0c536f"><td class="memItemLeft" align="right" valign="top"><a id="af1052ad4caa9dcc10e61545cdd0c536f" name="af1052ad4caa9dcc10e61545cdd0c536f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DoubleBuffer</b> (const <a class="el" href="classaspl_1_1_double_buffer.html">DoubleBuffer</a> &amp;)=delete</td></tr>
<tr class="separator:af1052ad4caa9dcc10e61545cdd0c536f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90fee78117a06b13e88c6b91f8374c39"><td class="memItemLeft" align="right" valign="top"><a id="a90fee78117a06b13e88c6b91f8374c39" name="a90fee78117a06b13e88c6b91f8374c39"></a>
<a class="el" href="classaspl_1_1_double_buffer.html">DoubleBuffer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classaspl_1_1_double_buffer.html">DoubleBuffer</a> &amp;)=delete</td></tr>
<tr class="separator:a90fee78117a06b13e88c6b91f8374c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff0a501a422dadc949e216b14365daf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html">ReadLock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaspl_1_1_double_buffer.html#a6ff0a501a422dadc949e216b14365daf">GetReadLock</a> () const</td></tr>
<tr class="memdesc:a6ff0a501a422dadc949e216b14365daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get locked read-only reference to the value. Non-blocking and lock-free, see <a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html" title="Read lock.">ReadLock</a>.  <a href="classaspl_1_1_double_buffer.html#a6ff0a501a422dadc949e216b14365daf">More...</a><br /></td></tr>
<tr class="separator:a6ff0a501a422dadc949e216b14365daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298d5b3ad1be61df18a470ce45f67e11"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaspl_1_1_double_buffer.html#a298d5b3ad1be61df18a470ce45f67e11">Get</a> () const</td></tr>
<tr class="memdesc:a298d5b3ad1be61df18a470ce45f67e11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get copy of the value. Non-blocking and lock-free, see <a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html" title="Read lock.">ReadLock</a>.  <a href="classaspl_1_1_double_buffer.html#a298d5b3ad1be61df18a470ce45f67e11">More...</a><br /></td></tr>
<tr class="separator:a298d5b3ad1be61df18a470ce45f67e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1337b25eca41b283d089d8bc1ed0662b"><td class="memTemplParams" colspan="2">template&lt;typename TT &gt; </td></tr>
<tr class="memitem:a1337b25eca41b283d089d8bc1ed0662b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classaspl_1_1_double_buffer.html#a1337b25eca41b283d089d8bc1ed0662b">Set</a> (TT &amp;&amp;value)</td></tr>
<tr class="memdesc:a1337b25eca41b283d089d8bc1ed0662b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set value.  <a href="classaspl_1_1_double_buffer.html#a1337b25eca41b283d089d8bc1ed0662b">More...</a><br /></td></tr>
<tr class="separator:a1337b25eca41b283d089d8bc1ed0662b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:ad50474af01078a4e9d0f276e86a3249d"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaspl_1_1_double_buffer.html#ad50474af01078a4e9d0f276e86a3249d">ReadLock</a></td></tr>
<tr class="separator:ad50474af01078a4e9d0f276e86a3249d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T&gt;<br />
class aspl::DoubleBuffer&lt; T &gt;</div><p >Doubly-buffered value with non-blocking read and blocking write. </p>
<p >Logically, this is a single-value container, which has getter and setter with the following characteristics:</p>
<ul>
<li>getters are running concurrently, and setters are serialized</li>
<li>setter is blocking; it may be blocked by both getters and setters, but in the average case only by setters</li>
<li>getter is non-blocking and lock-free; it does not block if a setter thread is suspended in the middle</li>
<li>getter is not wait-free though; if setters are called too frequently and have higher priority, then getter may spin until it has a chance to cut in between</li>
<li>sequential consistency is provided; after a setter returns, it's guaranteed that subsequent getters will observe up-to-date value</li>
</ul>
<p >Physically container is implemented as two copies of the value:</p>
<ul>
<li>one copy is read-only and used by getters (concurrently)</li>
<li>another one is for setters; basically, the setter updates its copy while it's not visible to getters, waits until all getter using another copy finish, and switches the copies</li>
</ul>
<p >The algorithm is optimized for the following use case:</p>
<ul>
<li>getters are frequent and setters are infrequent</li>
<li>the value is not very large and it's acceptable to make extra copies</li>
</ul>
<p >The value stored in the double buffer is immutable after it's set. To change the value, you need to call the getter, make a copy, modify it, and pass it to the setter.</p>
<p >The value should have public default and copy constructors. If it also has move constructor, it can be used in setter, and then only one copy is needed to update value. Otherwise, two copies are needed.</p>
<p >Typical reader looks like the following: </p><div class="fragment"><div class="line">DoubleBuffer&lt;T&gt; fooBuf;</div>
<div class="line">...</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">auto</span> readLock = fooBuf.GetReadLock();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> T&amp; fooValue = readLock.GetReference();</div>
<div class="line">  <span class="comment">// safe read-only access to fooValue until block end</span></div>
<div class="line">}</div>
</div><!-- fragment --><p >Or, if the reader is okay to call the copy constructor: </p><div class="fragment"><div class="line">DoubleBuffer&lt;T&gt; fooBuf;</div>
<div class="line">...</div>
<div class="line">T fooValue = fooBuf.Get();</div>
</div><!-- fragment --><p >Typical writer looks like this: </p><div class="fragment"><div class="line">DoubleBuffer&lt;T&gt; fooBuf;</div>
<div class="line">...</div>
<div class="line">T fooValue = fooBuf.Get();</div>
<div class="line"><span class="comment">// modify fooValue</span></div>
<div class="line">fooBuf.Set(std::move(fooValue));</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html" title="Read lock.">ReadLock</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_double_buffer_8hpp_source.html#l00091">91</a> of file <a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab904556765cb532ac19a40d79da100bd" name="ab904556765cb532ac19a40d79da100bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab904556765cb532ac19a40d79da100bd">&#9670;&nbsp;</a></span>DoubleBuffer() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classaspl_1_1_double_buffer.html">aspl::DoubleBuffer</a>&lt; T &gt;::DoubleBuffer </td>
          <td>(</td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize buffer with given value. </p>

<p class="definition">Definition at line <a class="el" href="_double_buffer_8hpp_source.html#l00192">192</a> of file <a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a>.</p>

</div>
</div>
<a id="ac667ea58ef5ad58f5b28f6cf32ce601b" name="ac667ea58ef5ad58f5b28f6cf32ce601b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac667ea58ef5ad58f5b28f6cf32ce601b">&#9670;&nbsp;</a></span>DoubleBuffer() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classaspl_1_1_double_buffer.html">aspl::DoubleBuffer</a>&lt; T &gt;::DoubleBuffer </td>
          <td>(</td>
          <td class="paramtype">T &amp;&amp;&#160;</td>
          <td class="paramname"><em>value</em> = <code>T()</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize buffer with given value. </p>

<p class="definition">Definition at line <a class="el" href="_double_buffer_8hpp_source.html#l00198">198</a> of file <a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a298d5b3ad1be61df18a470ce45f67e11" name="a298d5b3ad1be61df18a470ce45f67e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298d5b3ad1be61df18a470ce45f67e11">&#9670;&nbsp;</a></span>Get()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classaspl_1_1_double_buffer.html">aspl::DoubleBuffer</a>&lt; T &gt;::Get </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get copy of the value. Non-blocking and lock-free, see <a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html" title="Read lock.">ReadLock</a>. </p>

<p class="definition">Definition at line <a class="el" href="_double_buffer_8hpp_source.html#l00217">217</a> of file <a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a>.</p>

</div>
</div>
<a id="a6ff0a501a422dadc949e216b14365daf" name="a6ff0a501a422dadc949e216b14365daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ff0a501a422dadc949e216b14365daf">&#9670;&nbsp;</a></span>GetReadLock()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html">ReadLock</a> <a class="el" href="classaspl_1_1_double_buffer.html">aspl::DoubleBuffer</a>&lt; T &gt;::GetReadLock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get locked read-only reference to the value. Non-blocking and lock-free, see <a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html" title="Read lock.">ReadLock</a>. </p>

<p class="definition">Definition at line <a class="el" href="_double_buffer_8hpp_source.html#l00210">210</a> of file <a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a>.</p>

</div>
</div>
<a id="a1337b25eca41b283d089d8bc1ed0662b" name="a1337b25eca41b283d089d8bc1ed0662b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1337b25eca41b283d089d8bc1ed0662b">&#9670;&nbsp;</a></span>Set()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<div class="memtemplate">
template&lt;typename TT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classaspl_1_1_double_buffer.html">aspl::DoubleBuffer</a>&lt; T &gt;::Set </td>
          <td>(</td>
          <td class="paramtype">TT &amp;&amp;&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set value. </p>
<p >Blocks until all getters, invoked before this call, are finished. Concurrent setter calls are serialized.</p>
<p >It is guaranteed that if a getter is called after a setter returns, the getter will observe the updated value.</p>
<p >The value is either copied or moved into the internal buffer, depending on whether an lvalue or rvalue is passed. </p>

<p class="definition">Definition at line <a class="el" href="_double_buffer_8hpp_source.html#l00235">235</a> of file <a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="ad50474af01078a4e9d0f276e86a3249d" name="ad50474af01078a4e9d0f276e86a3249d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad50474af01078a4e9d0f276e86a3249d">&#9670;&nbsp;</a></span>ReadLock</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classaspl_1_1_double_buffer_1_1_read_lock.html">ReadLock</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_double_buffer_8hpp_source.html#l00271">271</a> of file <a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>aspl/<a class="el" href="_double_buffer_8hpp_source.html">DoubleBuffer.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>aspl</b></li><li class="navelem"><a class="el" href="classaspl_1_1_double_buffer.html">DoubleBuffer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
